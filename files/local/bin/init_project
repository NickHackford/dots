#!/usr/bin/env bash

is_bend_project() {
    if [ -f "package.json" ]; then
        grep -q '"bpm"' package.json
        return $?
    fi
    return 1
}

tmux new-window -n "nvim" ": nvim; zsh -i"
tmux send-keys -t "nvim" "vi" C-m

tmux new-window -n "claude" ": claude; zsh -i"
tmux send-keys -t "claude" "claude" C-m

tmux new-window -n "shell"
if is_bend_project; then
    tmux split-window -h -t "shell"
    tmux send-keys -t "shell".1 "bend yarn" C-m
    tmux send-keys -t "shell".1 "br"
fi

tmux new-window -n "lazygit" ": lazygit; zsh -i"
tmux send-keys -t "lazygit" "lg" C-m

tmux kill-window -t 1

tmux display-message "Project windows initialized!"
